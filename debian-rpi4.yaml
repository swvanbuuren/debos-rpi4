{{- $firmware_version := or .firmware_version "1.20230405" -}}
{{- $mirror := or .mirror "http://deb.debian.org/debian" -}}
{{- $suite := or .suite "bookworm" -}}
{{- $architecture := or .architecture "arm64" -}}
{{- $cmdline := or .cmdline " rootwait ro fsck.mode=auto fsck.repair=yes console=ttyS1,115200" -}}
{{- $image := or .image "debian-rpi4" -}}
{{- $username := or .username "user" -}}
{{- $hostname := or .username "raspberrypi" -}}
{{- $imagesize := or .imagesize "15.9GB" -}}

architecture: {{ $architecture }}

actions:

  - action: recipe
    description: Base recipe
    recipe: base.yaml
    variables:
      architecture: {{ $architecture}}
      firmware_version: {{ $firmware_version }}
      mirror: {{ $mirror }}
      suite: {{ $suite }}
      username: {{ $username }}
      hostname: {{ $hostname }}

  - action: recipe
    description: Recipe for creating image
    recipe: image.yaml
    variables:
      architecture: {{ $architecture }}
      cmdline: {{ $cmdline }}
      image: {{ $image }}
      imagesize: {{ $imagesize }}
